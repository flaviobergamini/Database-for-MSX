1 KEYOFF:COLOR 3,1: FOR A = 1 TO 10: KEY A,"":NEXT
2 SCREEN 3
3 OPEN "GRP:"AS#1
4 PRESET(10,20): PRINT#1," BANCO"
5 PRESET(50,70):PRINT#1," DE"
6 PRESET(40,130):PRINT#1, "DADOS"
7 FOR QW = 1 TO 3000: NEXT QW
8 CLOSE
9 CLS:SCREEN 0
10 CLEAR 5000: ZY=67:ZA=97:ZB=ZA+17:ZC=108:ZD=ZC+3:ZE=ZC-8:ZF=ZE+5:ZG=ZF+10:ZH=82
11 POKE 64683!,225:ZY$=CHR$(ZY)+CHR$(ZA)+CHR$(ZB)+CHR$(ZC)+CHR$(ZD)+CHR$(ZG):ZQ$=CHR$(ZH)+CHR$(ZF)+CHR$(99)+CHR$(ZA)+CHR$(ZB)+CHR$(ZE)+CHR$(ZD)
12 DEFSTRA-H:DEFINTI-S
13 B="":F1="########.##"
14 MF=7:MI=ZY-7
15 DIM D(MF),AT(MF),F(MF),T(MF),NF(MF)
16 DIM O(MI), Y(MI), B(MI), A(MF,MI), X(MF,MI)
17 ONERRORGOTO74
18 CLS
19 PRINT STRING$(39,200)
20 PRINT "Produzido por";Z$;" & "ZQ$
21 PRINT STRING$(39,200)
22 PRINT
23 PRINT TAB(12)"BANCO DE DADOS"
24 PRINT TAB(12)"----- -- -----"
25 PRINT TAB(12)"SELECIONE A OPCAO:":PRINT
26 PRINT TAB(12)"1 - Criar novo arquivo"
27 PRINT TAB(12)"2 - Carregar um arquivo":PRINT
28 PRINT STRING$(39,200):PRINT
29 PRINT:PRINT"     --> ";:INPUT "OPCAO: ";N
30 IF ZC <> 108 THEN NEW
31 IF N < 1 OR N > 32 THEN 23
32 ONN GOTO 33,47
33 CLS:NF=0:NI=0:PRINT "Defina os campos:":PRINT STRING$(39,200)
34 PRINT "Entre com a definicao:":PRINT"<N> para numerico ou <A> para alfa": PRINT STRING$(39,200)
35 FOR I=0 TO MF: AT(I)="": D(I)=""
36 PRINT "Campo no. "I+1;:INPUT D(I), AT(I)
37 IF LEN(D(I))>10 THEN (I) = LEFT$(D(I),10)
38 IF D(I)="" THEN 42
39 IF AT(I)="N" OR AT(I)="A" THEN 41
40 PRINT "Voce deve especificar <N> ou <A>": GOTO 36
41 NEXT I
42 NF=I-1:NI=-1
43 CLS:PRINT "O banco tem";NF+1;"campos, desta maneira:"
44 FOR I = 0 TO NF
45 PRINT "Campo no. ";I+1;":"; D(I); TAB(30);AT(I)
46 NEXT I: GOSUB 69: GOTO 74
47 CLS:LOCATE 0,11:PRINT "O arquivo foi gravado em <D>isco ou <F>ita?"
48 HJ$=INKEY$:IF HJ$=""THEN 47 ELSEIF HJ$="F" THEN 49 ELSEIF HJ$="D"THEN 60 ELSE 48 
49 CLS:PRINT "Prepare o cassete"
50 PRINT"<ENTER>+<CONTROL>+<STOP> p/ voltar": GOSUB 69
51 OPEN"CAS:"FOR INPUT AS#1
52 INPUT #1,NI,NF
53 FOR I=0 TO NF: INPUT #1,D(I),AT(I):NEXT I
54 FOR J=0 TO NI:FOR I=0 TO NF: IF AT(I)="N"THEN 57
55 IF AT(I)="A" THEN 58
56 PRINT "ERRO DE LEITURA"; GOSUB 69: GOTO 23
57 INPUT #1,X(I,J):GOTO 59
58 INPUT #1,A(I,J):NU=NI+1:IF NU-J=0 THEN 43
59 NEXT I,J:CLOSE:GOTO 43
60 CLS:INPUT "Nomedo arq. a ser chamado";CU$
61 OPEN"A:"+CU$+".ARQ" FOR INPUT AS$1
62 INPUT #1,NI,NF
63 FOR I=0 TO NF: INPUT#1, D(I), AT(I):NEXT I
64 FOR J=0 TO NI:FOR I=0 TO NF:IF AT(I)="N"THEN 66
65 IF AT(I)="A" THEN 67
66 INPUT #1,X(I,J):GOTO 68
67 INPUT #1,A(I,J):NU=NI+1:IF NU-J = 0 THEN 43
68 NEXT I,J:CLOSE:GOTO 43
69 PRINT:INPUT"APERTE 'ENTER' QUANDO ESTIVER PRONTO";EN
70 RETURN
71 PRINT"Esta correto (S/N) ";
72 INPUT A$: IF A$="S" OR A$="N" THEN RETURN
73 PRINT "Responda com 'S' ou 'N'": GOTO 72
74 CLS:PRINT TAB(10);"Comandos do sistema:":PRINT STRING$(39,200):PRINT
75 PRINT"C-COLOCAR       ***       L-LISTAR " 
76 PRINT"M-MODIFICAR     ***       N-NOVO BANCO " 
77 PRINT"D-DELETAR       ***       S-SAIR       "
78 PRINT"O-ORDENAR       ***       P-PROCURAR   "
79 PRINT"J-JUST.IMP.     ***       G-GRAVAR"
80 PRINT"T-TOTALIZAR     ***       I-IMPRIMIR "
81 PRINT"R-REDEFINIDOR   ***       F-FIRETORIO"
82 PRINT:PRINT STRING$(39,200):PRINT" ---> ";:INPUT "COMANDO ";A
83 IF LEN(A)<>1 THEN 74
84 RESTORE:FOR I=1 TO 14
85 READ C,N: IF A=C THEN CLS:GOTO 87
86 NEXT I: GOTO 74
87 ONNGOTO91,110,118,88,128,222,228,23,244,145,163, 179,266,276
88 GOTO 260
89 DATA"C",1,"M",2,"D",3,"S",4,"P",5,"J",6,"L",7
90 DATA "N",8,"I",9,"0",10,"T",11,"G",12,"R",13,"F",14
91 NI=NI+1:J=NI
92 GOSUB 98:GOSUB 104
93 GOSUB 71
94 IFA<>"S"THEN 92
95 PRINT"Banco contem";NI+1;" registros."
96 PRINT:PRINT"Colocar outro registro (S/N)";:GOSUB 72
97 IF A="S" THEN 91 ELSE 74
98 CLS:PRINT "No. do registro";J+1:PRINT
99 FOR I=0 TO NF:PRINT D(I);
100 IF AT(I)="N" THEN 102
101 INPUT A(I,J):X(I,J)=0:GOTO 103
102 INPUT X(I,J):A(I,J)=""
103 NEXT I:RETURN
104 CLS:PRINT "Registro No.";J+1;"agora esta assim:"
105 PRINT:FOR I=0 TO NF: PRINT D(I); TAB(11);
106 IF AT(I)="N" THEN 108
107 PRINT B; A(I,J):GOTO 109
108 PRINT USING F1;X(I,J)
109 NEXT I:PRINT:RETURN
110 INPUT "No. do registro a modificar";J
111 IF J>0 AND J<NI+2 THEN J=J-1:GOTO 113
112 PRINT "Registro No.";J;"nao esta no banco":GOTO 116
113 GOSUB 104
114 GOSUB 71
115 IF A<>"S" THEN GOSUB 98:GOTO113
116 PRINT:PRINT "Modificar outro registro (S/N)";: GOSUB 72
118 INPUT "No. Registro a ser deletado";J
119 J=J-1:IF J>=0 AND J<= NI THEN 121
120 PRINT "Registro No.";J+1;"nao esta no banco":GOTO 126
121 IF J=NI THEN 125 ELSE K=J-1
122 K=K+1:FOR I\0 TO NF
123 A(I,K)=A(I,K+1):X=(I,K+1):NEXT I
124 IF K<NI-1 THEN 122
125 NI=NI-1:PRINT"Banco comtem";NI+1;"registros"
126 PRINT:PRINT "Deletar outro registro (S/N)";: GOSUB 72
127 IF A="S" THEN 118 ELSE 74
128 A="a ser procurado"
129 FOR I=0 TO NF
130 PRINT"Campo No.  ";I+1;D(I)
131 NEXT I
132 GOSUB 142
133 PRINT "Entre expressao a ser procurada";
134 IF AT(M)"N" THEN INPUT X:L=2:GOTO 136
135 INPUT A:L=1
136 K=0:FOR J=0 TO NI:ON L GOTO 137,138
137 U=LEN(A):IF LEFT$(A(M,J),U)<>A THEN 140 ELSE 139
138 IF X(M,J)<>X THEN 140
139 GOSUB 104:GOSUB 69:K=K+1
140 NEXT J:CLS
141 PRINT K;"REGISTROS ENCONTRADOS.":GOSUB 69:GOTO 74
142 PRINT "Entre o No. do campo ";A;:INPUT M
143 M=M-1:IF M>=0 AND M<= NF THEN RETURN
144 PRINT "No. de campo ilegal": GOTO 142
145 A= "a ser ordenado"
146 FOR I=0 NF
147 PRINT "Campo No. ";I+1;D(I)
148 NEXT I
149 GOSUB 142
150 IF AT(M)="A"THEN 157
151 FOR I=0 TO NI:O(I)=I:Y(I)=X(M,I):NEXT I
152 FOR FOR J=0 TO NI-1
153 FOR I=J TO NI:IF Y(J)<=Y(I) THEN 156
154 Y=Y(J):Y(J)=Y(I):Y(I)=Y
155 O=O(J):O(J)=O(I):O(I)=0:GOTO 153
156 NEXT I,J: GOTO 74
157 FOR I=0 TO NI:O(I)=I:B(I)=A(M,I):NEXT I
158 FOR J=0 TO NI-1
159 FOR I=J+1 TO NI:IF B(J) <= B(I) THEN 162
160 C=B(J):B(J)=B(I):B(I)=C
161 O=O(J):O(J)=O(I):O(I)=O:GOTO 159
162 NEXT I,J:GOTO 74
163 A="Para totalizar"
164 FOR I=0 TO NF
165 IF AT(I)="N"THEN PRINT "Campo No. ";I+1;D(I)
166 NEXT I
167 GOSUB 142
168 PRINT "Totalizar todos os registros (S/N) ";:GOSUB 72
169 IF A="S"THEN 171
170 GOTO 74
171 I=0:K=0:FOR I=0 TO NI:IF A="S"THEN 175
172 IF AT(MC)="N"THEN 174
173 IF A=A(MC,I) THEN 175 ELSE 176
174 IF X<>X(MC,I)THEN 176
175 T=T+X(M,I):K=K+1
176 NEXT I
177 PRINT:PRINT "Total para o campo < ";B;D(M);B;" > e ":PRINT USING F1;T
178 PRINT K; "Itens somados":GOSUB69:GOTO 74
179 N=1:GOTO180
180 CLS:LOCATE0,11:PRINT "Quer gravar em <D>isco ou <F>ita?"